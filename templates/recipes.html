{% extends "base.html" %}

{% block title %}Recipes - Cook{% endblock %}

{% block content %}
<div>
    {% if !breadcrumbs.is_empty() %}
    <nav class="mb-4">
        <ol class="flex space-x-2 text-sm text-gray-600">
            <li><a href="/" class="hover:text-gray-900">Recipes</a></li>
            {% for crumb in breadcrumbs %}
            <li class="flex items-center">
                <span class="mx-2 text-gray-400">/</span>
                <a href="/directory/{{ crumb.path }}" class="hover:text-gray-900">{{ crumb.name }}</a>
            </li>
            {% endfor %}
        </ol>
    </nav>
    {% endif %}

    <h1 class="text-3xl font-bold mb-8 bg-gradient-to-r from-orange-600 to-yellow-600 bg-clip-text text-transparent">
        {{ current_name }}
    </h1>

    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for item in items %}
        {% if item.is_directory %}
        <a href="/directory/{{ item.path }}" class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all hover:scale-105 recipe-card flex flex-col">
            <div class="p-6 flex-1">
                <div class="flex items-center justify-center w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mb-4">
                    <span class="text-2xl">üìÅ</span>
                </div>
                <h3 class="font-bold text-lg mb-2">{{ item.name }}</h3>
                {% match item.count %}
                {% when Some with (count) %}
                <span class="text-sm text-orange-600 font-medium">{{ count }} recipes</span>
                {% when None %}
                {% endmatch %}
            </div>
        </a>
        {% else %}
        <a href="/recipe/{{ item.path }}" class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all hover:scale-105 recipe-card flex flex-col">
            {% match item.image_path %}
            {% when Some with (img) %}
            <div class="h-48 bg-gray-100 overflow-hidden">
                <img src="{{ img }}" alt="{{ item.name }}" class="w-full h-full object-cover hover:scale-110 transition-transform duration-300">
            </div>
            <div class="p-6">
            {% when None %}
            <div class="p-6">
                <div class="flex items-center justify-center w-16 h-16 bg-gradient-to-br {% if item.is_menu %}from-purple-400 to-pink-500{% else %}from-orange-400 to-pink-500{% endif %} rounded-full mb-4">
                    <span class="text-2xl">{% if item.is_menu %}üìã{% else %}üçΩÔ∏è{% endif %}</span>
                </div>
            {% endmatch %}
            <h3 class="font-bold text-lg mb-2 text-gray-800">
                {{ item.name }}
                {% if item.is_menu %}
                <span class="ml-2 text-xs bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 px-2 py-1 rounded-full font-semibold">Menu</span>
                {% endif %}
            </h3>
            {% match item.description %}
            {% when Some with (description) %}
            <p class="text-gray-600 text-sm">{{ description }}</p>
            {% when None %}
            {% endmatch %}
            {% if !item.tags.is_empty() %}
            <div class="mt-3 flex flex-wrap gap-2">
                {% for tag in item.tags.iter().take(3) %}
                <span class="text-xs bg-gradient-to-r from-yellow-100 to-orange-100 text-orange-700 px-2 py-1 rounded-full font-medium">{{ tag }}</span>
                {% endfor %}
                {% if item.tags.len() > 3 %}
                <span class="text-xs text-gray-500">+{{ item.tags.len() - 3 }}</span>
                {% endif %}
            </div>
            {% endif %}
            </div>
        </a>
        {% endif %}
        {% endfor %}

        {% if items.is_empty() %}
        <div class="text-gray-500 text-center py-8">
            No recipes found in this directory.
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
