{% extends "base.html" %}

{% block title %}Recipes - Cook{% endblock %}

{% block content %}
<div class="container-bounds wrap-text">
    {% if !breadcrumbs.is_empty() %}
    <nav class="mb-4">
        <ol class="flex space-x-2 text-sm text-gray-600">
            <li><a href="/" class="hover:text-gray-900">Recipes</a></li>
            {% for crumb in breadcrumbs %}
            <li class="flex items-center">
                <span class="mx-2 text-gray-400">/</span>
                <a href="/directory/{{ crumb.path }}" class="hover:text-gray-900">{{ crumb.name }}</a>
            </li>
            {% endfor %}
        </ol>
    </nav>
    {% endif %}

    <h1 class="text-3xl font-bold mb-8 text-gray-900 dark:text-white">
        {{ current_name }}
    </h1>

    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
        {% for item in items %}
        {% if item.is_directory %}
        <a href="/directory/{{ item.path }}" class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600 transition-all flex flex-col container-bounds">
            <div class="p-4 sm:p-6 flex-1">
                <div class="flex items-center justify-center w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 dark:bg-gray-700 rounded-full mb-4">
                    <span class="text-xl sm:text-2xl">üìÅ</span>
                </div>
                <h3 class="font-semibold text-base sm:text-lg mb-2 text-gray-900 dark:text-white wrap-text">{{ item.name }}</h3>
                {% match item.count %}
                {% when Some with (count) %}
                <span class="text-sm text-gray-600 dark:text-gray-400">{{ count }} recipes</span>
                {% when None %}
                {% endmatch %}
            </div>
        </a>
        {% else %}
        <a href="/recipe/{{ item.path }}" class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600 transition-all flex flex-col container-bounds">
            {% match item.image_path %}
            {% when Some with (img) %}
            <div class="h-40 sm:h-48 bg-gray-100 dark:bg-gray-700 overflow-hidden">
                <img src="{{ img }}" alt="{{ item.name }}" class="w-full h-full object-cover">
            </div>
            <div class="p-4 sm:p-6">
            {% when None %}
            <div class="p-4 sm:p-6">
                <div class="flex items-center justify-center w-12 h-12 sm:w-16 sm:h-16 {% if item.is_menu %}bg-purple-100 dark:bg-purple-900{% else %}bg-orange-100 dark:bg-orange-900{% endif %} rounded-full mb-4">
                    <span class="text-xl sm:text-2xl">{% if item.is_menu %}üìã{% else %}üçΩÔ∏è{% endif %}</span>
                </div>
            {% endmatch %}
            <h3 class="font-semibold text-base sm:text-lg mb-2 text-gray-900 dark:text-white wrap-text">
                {{ item.name }}
                {% if item.is_menu %}
                <span class="ml-2 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 px-2 py-1 rounded-full font-medium">Menu</span>
                {% endif %}
            </h3>
            {% match item.description %}
            {% when Some with (description) %}
            <p class="text-gray-600 dark:text-gray-400 text-sm mb-3 wrap-text">{{ description }}</p>
            {% when None %}
            {% endmatch %}
            {% if !item.tags.is_empty() %}
            <div class="flex flex-wrap gap-2">
                {% for tag in item.tags.iter().take(3) %}
                <span class="text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-2 py-1 rounded-full">{{ tag }}</span>
                {% endfor %}
                {% if item.tags.len() > 3 %}
                <span class="text-xs text-gray-500 dark:text-gray-400">+{{ item.tags.len() - 3 }}</span>
                {% endif %}
            </div>
            {% endif %}
            </div>
        </a>
        {% endif %}
        {% endfor %}

        {% if items.is_empty() %}
        <div class="text-gray-500 text-center py-8">
            No recipes found in this directory.
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
